# Лабораторная работа 1. Метод линейной регрессии

## Введение
*[Отчет по лабораторной работе № 4](https://github.com/ITSamantha/artificial_intelligence_systems/tree/main/module2/lab4)*
### Цель
Целью данной лабораторной работы является реализация метода линейной регрессии с использованием метода наименьших квадратов. В ходе выполнения лабораторной работы студентам предстоит провести анализ и обработку данных, построить модели линейной регрессии с разными наборами признаков, и оценить их производительность с использованием коэффициента детерминации.
### Задача
- Студенты с четным порядковым номером в группе должны использовать набор данных о [жилье в Калифорнии] (https://developers.google.com/machine-learning/crash-course/california-housing-data-description?hl=ru). [Скачать тут](https://download.mlcc.google.com/mledu-datasets/california_housing_train.csv).
- Получите и визуализируйте статистику по датасету (включая количество, среднее значение, стандартное отклонение, минимум, максимум и различные квантили).
- Проведите предварительную обработку данных, включая обработку отсутствующих значений, кодирование категориальных признаков и нормировка.
- Разделите данные на обучающий и тестовый наборы данных.
- Реализуйте линейную регрессию с использованием метода наименьших квадратов без использования сторонних библиотек, кроме NumPy и Pandas. Использовать минимизацию суммы квадратов разностей между фактическими и предсказанными значениями для нахождения оптимальных коэффициентов.
- Постройте **три модели** с различными наборами признаков.
- Для каждой модели проведите оценку производительности, используя метрику коэффициент детерминации, чтобы измерить, насколько хорошо модель соответствует данным.
- Сравните результаты трех моделей и сделайте выводы о том, какие признаки работают лучше всего для каждой модели.
- Бонусное задание
    - Ввести синтетический признак при построении модели

## Описание метода
Метод линейной регрессии - это статистический метод, который используется для анализа и моделирования линейных отношений между зависимой переменной (целевой) и набором независимых переменных (признаков). Его назначение заключается в поиске оптимальной линейной функции, которая наилучшим образом соответствует данным и позволяет предсказывать значения целевой переменной на основе значений признаков.

Принцип работы метода заключается в нахождении параметров (весов) линейной функции, которая минимизирует сумму квадратов разностей между фактическими и предсказанными значениями целевой переменной. Это делается с использованием метода наименьших квадратов, который находит оптимальные веса, минимизируя сумму квадратов остатков.

Метод линейной регрессии широко применяется в различных областях, таких как экономика, финансы, медицина, маркетинг и многие другие, для анализа данных и предсказания будущих событий.

## Псевдокод метода
```
Функция ОбучитьЛинейнуюРегрессию(X, y):
    # X - матрица признаков, y - вектор целевых значений
    # Добавить столбец из единиц для свободного члена
    X = добавить_единичный_столбец(X)
    
    # Найти оптимальные веса с использованием метода наименьших квадратов
    beta = обратная((X^T * X)) * X^T * y
    
    Вернуть beta

Функция Предсказать(X, beta):
    # X - матрица признаков, beta - вектор весов
    # Добавить столбец из единиц для свободного члена
    X = добавить_единичный_столбец(X)
    
    # Предсказать значения целевой переменной
    y_pred = X * beta
    
    Вернуть y_pred

# Обучение модели
beta = ОбучитьЛинейнуюРегрессию(X_train, y_train)

# Предсказание значений
y_pred = Предсказать(X_test, beta)
```

## Результаты выполнения 
После применения метода линейной регрессии к набору данных о жилье в Калифорнии, получили следующие результаты.
### Анализ данных и визуализация
Проанализирован набор данных и вычислена статистика, включая количество, среднее значение, стандартное отклонение, минимум, максимум и различные квантили для каждого признака.
Визуализированы данные, чтобы лучше понять их распределение и корреляцию между признаками. Примеры визуализации данных были представлены в отчете.

- Описание датасета:
  
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/38530f9c-a960-4f7b-bd8a-3a9c7726c2b0)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/6e2d0169-180d-49f7-90cd-59aed5c53897)

- Описание статистики атрибута:
  
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/4e747427-a03b-4f4c-935d-4db293f1f68d)

- Визуализация
![boxplots](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/02d74956-3033-40ea-a26e-5ed1a36e0542)
![heat_map](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/a95c32ab-39c1-426f-a53a-923e60a66e20)


### Предварительная обработка данных
Проведена предварительная обработка данных, включая обработку отсутствующих значений и нормализацию признаков. Это позволило улучшить сходимость модели.

- Предварительная обработка данных
  
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/c060c474-a3be-4711-8d5f-92cc607f5d9d)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/6e0e8c5f-eb63-4057-a67d-809b1b6cdbe4)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/aee759c7-7fe6-455c-9a29-9498d5ab842c)


### Построение моделей
Построены три модели линейной регрессии с разными наборами признаков. Каждая модель использовала разные комбинации признаков для предсказания цен на жилье.

- Модели
  
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/d9e5d14e-ecea-4976-8973-3ee65cecffd7)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/9dd3003f-f149-47ef-b3c3-c0b12f91c07e)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/888922a3-88ab-424d-a440-adf95803cd0e)


### Оценка производительности
Для каждой модели мы провели оценку производительности, используя метрику коэффициента детерминации. Этот коэффициент измеряет, насколько хорошо модель соответствует данным, где 1 - идеальное соответствие, а 0 - модель не лучше, чем простое среднее значение.
### Лучший результат
Наилучший показатель коэффициента детерминации составил 0.652002. Это означает, что наша лучшая модель объяснила около 65.2% дисперсии в данных, что можно считать довольно неплохим результатом.
Наиболее удачной оказалась модель с наборами атрибутов:  
- median_income,
- latitude,
- longitude,
- housing_median_age,
- total_rooms,
- median_house_value,
- bedrooms_households.

## Примеры использования метода
Метод линейной регрессии является мощным и широко используемым инструментом в анализе данных и прогнозировании в различных областях. Вот несколько примеров ситуаций, когда метод линейной регрессии может быть полезен:

- *Экономический анализ*
Метод линейной регрессии может быть использован для анализа зависимости между экономическими показателями, такими как ВВП, инфляция, безработица и другими факторами. Это позволяет экономистам оценивать влияние различных переменных на экономическую динамику и прогнозировать будущие тренды.
- *Финансовый анализ*
В финансовой сфере линейная регрессия может быть использована для анализа зависимости цен на акции от различных финансовых показателей, таких как объем торгов, ставки процента, доходность облигаций и другие факторы. Это помогает инвесторам и трейдерам принимать более обоснованные решения.
- *Маркетинг и реклама*
В маркетинге и рекламе линейная регрессия может быть использована для анализа влияния маркетинговых расходов на продажи и доходность. Это помогает маркетологам оптимизировать бюджеты и выбирать наиболее эффективные кампании.
- *Медицинская статистика*
В медицинской статистике метод линейной регрессии может быть применен для анализа зависимости между клиническими параметрами и результатами лечения пациентов. Это помогает исследователям и врачам выявить факторы, влияющие на заболевания и выбирать наилучшие методы лечения.
- *Прогнозирование временных рядов*
Метод линейной регрессии может быть использован для прогнозирования временных рядов, таких как продажи, температура, финансовые показатели и другие. Это помогает в предсказании будущих значений и планировании ресурсов.

Метод линейной регрессии является простым и понятным методом, который хорошо подходит для анализа линейных зависимостей в данных. Кроме того, он легко интерпретируем, что делает его полезным инструментом для анализа и объяснения отношений между переменными. В случаях, когда зависимость может быть описана линейной функцией, метод линейной регрессии часто является предпочтительным выбором.
