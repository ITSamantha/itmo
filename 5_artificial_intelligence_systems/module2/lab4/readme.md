# Лабораторная работа №4. Линейная регрессия

Целью этой лабораторной работы является реализация линейной регрессии с использованием метода наименьших квадратов.

## Задание
- Студенты с четным порядковым номером в группе должны использовать набор данных о [жилье в Калифорнии](https://developers.google.com/machine-learning/crash-course/california-housing-data-description?hl=ru).
  [Скачать тут](https://download.mlcc.google.com/mledu-datasets/california_housing_train.csv) .
- Получите и визуализируйте статистику по датасету (включая количество, среднее значение, стандартное отклонение, минимум, максимум и различные квантили).
- Проведите предварительную обработку данных, включая обработку отсутствующих значений, кодирование категориальных признаков и нормировка.
- Разделите данные на обучающий и тестовый наборы данных.
- Реализуйте линейную регрессию с использованием метода наименьших квадратов без использования сторонних библиотек, кроме NumPy и Pandas. Использовать минимизацию суммы квадратов разностей между фактическими и предсказанными значениями для нахождения оптимальных коэффициентов.
- Постройте **три модели** с различными наборами признаков.
- Для каждой модели проведите оценку производительности, используя метрику коэффициент детерминации, чтобы измерить, насколько хорошо модель соответствует данным.
- Сравните результаты трех моделей и сделайте выводы о том, какие признаки работают лучше всего для каждой модели.
- Бонусное задание
    - Ввести синтетический признак при построении модели

## Реализация
Получение статистики реализовано с помощью библиотеки Pandas. Визуализация данных реализована с помощью библиотек Seaborn и matplotlib.pyplot. Кодирование категориальных признаков в данном случае не нужно, нормировка реализована.
Для реализации линейной регресиии был выбран "Матричный метод". Он заключается в нахождении вектора параметров регресии B = (X'X)^(-1)X'Y. Функция нахождения коэффиицента детерминации (R2) также реализована. Был введен синтетический признак в качестве PCA (слияние двух наиболее коррелированных признаков) - bedrooms_households. Были построены модели с различными параметрами (параметры на каждом шаге выбираются рандомно, что позволяет оценить больший спектр моделей). 

### Примеры работы

- Описание датасета:
  
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/38530f9c-a960-4f7b-bd8a-3a9c7726c2b0)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/6e2d0169-180d-49f7-90cd-59aed5c53897)

- Описание статистики атрибута:
  
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/4e747427-a03b-4f4c-935d-4db293f1f68d)

- Предварительная обработка данных
  
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/c060c474-a3be-4711-8d5f-92cc607f5d9d)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/6e0e8c5f-eb63-4057-a67d-809b1b6cdbe4)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/aee759c7-7fe6-455c-9a29-9498d5ab842c)

- Модели
  
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/d9e5d14e-ecea-4976-8973-3ee65cecffd7)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/9dd3003f-f149-47ef-b3c3-c0b12f91c07e)
![image](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/888922a3-88ab-424d-a440-adf95803cd0e)

### Визуализация данных

![boxplots](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/02d74956-3033-40ea-a26e-5ed1a36e0542)
![heat_map](https://github.com/ITSamantha/Artificial_Intelligence_Systems/assets/100091168/a95c32ab-39c1-426f-a53a-923e60a66e20)

## Вывод
В ходе работы я научилась анализировать и визуализировать датасет, проводить предварительную обратботку данных, включая обработку отсутствующих значений, кодирование категориальных признаков и нормировку. Также я реализовала методы линейной регрессии средствами языка Python и библиотек NumPy и Pandas. Был введен синтетический признак в качестве PCA (слияние двух наиболее коррелированных признаков) - bedrooms_households. Были построены модели с различными параметрами. 
Наиболее удачной оказалась модель с наборами атрибутов:  
- median_income,
- latitude,
- longitude,
- housing_median_age,
- total_rooms,
- median_house_value,
- bedrooms_households.

**Лучший показатель коэффициента детерминации составил: 0,652002.**
